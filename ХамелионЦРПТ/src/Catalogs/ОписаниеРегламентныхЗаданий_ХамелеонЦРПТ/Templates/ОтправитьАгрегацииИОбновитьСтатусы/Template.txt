		// Вставить содержимое обработчика.
	
	ГлубинаПериода=3;
	

	
	
//{{КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
// Данный фрагмент построен конструктором.
// При повторном использовании конструктора, внесенные вручную изменения будут утеряны!!!

Запрос = Новый Запрос;
Запрос.Текст = 
	"ВЫБРАТЬ
	|	СозданиеНовогоШкНаКороба_ХамелеонЦРПТ.Ссылка,
	|	СозданиеНовогоШкНаКороба_ХамелеонЦРПТ.ТекущийПользователь
	|ИЗ
	|	Документ.СозданиеНовогоШкНаКороба_ХамелеонЦРПТ КАК СозданиеНовогоШкНаКороба_ХамелеонЦРПТ
	|ГДЕ
	|	СозданиеНовогоШкНаКороба_ХамелеонЦРПТ.Статус = ЗНАЧЕНИЕ(Перечисление.СтатусыДокументов_ХамелеонЦРПТ.ПодготовленКОтправке)
	|	И НЕ СозданиеНовогоШкНаКороба_ХамелеонЦРПТ.ПометкаУдаления
	|	И СозданиеНовогоШкНаКороба_ХамелеонЦРПТ.Дата >= &Дата";

Запрос.УстановитьПараметр("Дата", НачалоДня(НачалоДня)-ГлубинаПериода*24*60*60);


РезультатЗапроса = Запрос.Выполнить();

ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();

Пользователи_1=Новый Массив;
Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
	// Вставить обработку выборки ВыборкаДетальныеЗаписи
	Попытка
	ОбщийМодуль_НаСервере_ХамелеонЦРПТ.ОтправитьАгрегациюНаСервере_ХамелеонЦРПТ(ВыборкаДетальныеЗаписи.ТекущийПользователь,
		ВыборкаДетальныеЗаписи.Ссылка);
	Исключение
	КонецПопытки;
		Если Пользователи_1.Найти(ВыборкаДетальныеЗаписи.ТекущийПользователь)=Неопределено Тогда
			
			Пользователи_1.Добавить(ВыборкаДетальныеЗаписи.ТекущийПользователь);
		Конецесли;
КонецЦикла
	;

//}}КОНСТРУКТОР_ЗАПРОСА_С_ОБРАБОТКОЙ_РЕЗУЛЬТАТА
Для Каждого Стр_1 Из Пользователи_1 Цикл
	Попытка
		ОбщийМодуль_НаСервере_ХамелеонЦРПТ.ОбновитьСтатусыДокументовСерверПоПользователю(ТекущийПользователь)
	Исключение
	КонецПопытки;
КонецЦикла;
