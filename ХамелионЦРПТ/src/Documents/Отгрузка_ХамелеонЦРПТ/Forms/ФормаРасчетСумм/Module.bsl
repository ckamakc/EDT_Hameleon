
&НаКлиенте
Процедура ТаблицаСуммИКоличествПередУдалением(Элемент, Отказ)
	Отказ=Истина
КонецПроцедуры

&НаКлиенте
Процедура ТаблицаСуммИКоличествПередНачаломДобавления(Элемент, Отказ, Копирование, Родитель, Группа, Параметр)
	Отказ=Истина;
КонецПроцедуры

&НаСервере
Процедура РассчитатьНДСИСуммуНаСервере()
	// Вставить содержимое обработчика.
	Для Каждого Стр Из ТаблицаСуммИКоличеств Цикл
		Стр.Сумма=Стр.КоличествоКМ*Стр.Цена;
		Если Стр.СтавкаНДС=Перечисления.СтавкаНДС_ХамелеонЦРПТ.БезНДС
			ИЛИ Стр.СтавкаНДС=Перечисления.СтавкаНДС_ХамелеонЦРПТ.НДС0 Тогда
			Стр.НДС=0
		ИначеЕсли Стр.СтавкаНДС=Перечисления.СтавкаНДС_ХамелеонЦРПТ.НДС10
			Тогда
			Стр.НДС=Стр.Сумма*10/110;
		Иначе
			Стр.НДС=Стр.Сумма*20/120;
		КонецЕсли;
		
		
	Конеццикла;
КонецПроцедуры

&НаКлиенте
Процедура РассчитатьНДСИСумму(Команда)
	РассчитатьНДСИСуммуНаСервере();
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	// Вставить содержимое обработчика.
	
	Табл=Параметры.ТаблицаЗнач;
	Для КаждогО Стр_1 Из Табл Цикл
		Добав=ТаблицаСуммИКоличеств.Добавить();
		ЗаполнитьЗначенияСвойств(Добав,Стр_1);
	Конеццикла;
	
КонецПроцедуры

&НаКлиенте
Процедура ПеренестиДанные(Команда)
	// Вставить содержимое обработчика.
	Масс=Новый Массив;
	Для Каждого Стр_2 Из ТаблицаСуммИКоличеств Цикл
		Масс.Добавить(Новый Структура("GTIN,КоличествоКМ,НомерСтроки,Сумма,Цена,НДС,СтавкаНДС",
		Стр_2.GTIN,Стр_2.КоличествоКМ,Стр_2.НомерСтроки,Стр_2.Сумма,Стр_2.Цена,Стр_2.НДС,Стр_2.СтавкаНДС));
	Конеццикла;
	
	ЭтаФорма.Закрыть(Масс);
КонецПроцедуры
